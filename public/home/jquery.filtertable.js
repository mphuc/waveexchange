(function($){var jversion=$.fn.jquery.split('.'),jmajor=parseFloat(jversion[0]),jminor=parseFloat(jversion[1]);if(jmajor<2&&jminor<8){$.expr[':'].filterTableFind=function(a,i,m){return $(a).text().toUpperCase().indexOf(m[3].toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0;};$.expr[':'].filterTableFindAny=function(a,i,m){var raw_args=m[3].split(/[\s,]/),args=[];$.each(raw_args,function(j,v){var t=v.replace(/^\s+|\s$/g,'');if(t){args.push(t);}});if(!args.length){return false;}
return function(a){var found=false;$.each(args,function(j,v){if($(a).text().toUpperCase().indexOf(v.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0){found=true;return false;}});return found;};};$.expr[':'].filterTableFindAll=function(a,i,m){var raw_args=m[3].split(/[\s,]/),args=[];$.each(raw_args,function(j,v){var t=v.replace(/^\s+|\s$/g,'');if(t){args.push(t);}});if(!args.length){return false;}
return function(a){var found=0;$.each(args,function(j,v){if($(a).text().toUpperCase().indexOf(v.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0){found++;}});return found===args.length;};};}else{$.expr[':'].filterTableFind=jQuery.expr.createPseudo(function(arg){return function(el){return $(el).text().toUpperCase().indexOf(arg.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0;};});$.expr[':'].filterTableFindAny=jQuery.expr.createPseudo(function(arg){var raw_args=arg.split(/[\s,]/),args=[];$.each(raw_args,function(i,v){var t=v.replace(/^\s+|\s$/g,'');if(t){args.push(t);}});if(!args.length){return false;}
return function(el){var found=false;$.each(args,function(i,v){if($(el).text().toUpperCase().indexOf(v.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0){found=true;return false;}});return found;};});$.expr[':'].filterTableFindAll=jQuery.expr.createPseudo(function(arg){var raw_args=arg.split(/[\s,]/),args=[];$.each(raw_args,function(i,v){var t=v.replace(/^\s+|\s$/g,'');if(t){args.push(t);}});if(!args.length){return false;}
return function(el){var found=0;$.each(args,function(i,v){if($(el).text().toUpperCase().indexOf(v.toUpperCase().replace(/"""/g,'"').replace(/"\\"/g,"\\"))>=0){found++;}});return found===args.length;};});}
$.fn.filterTable=function(options){var defaults={autofocus:false,callback:null,containerClass:'filter-table',containerTag:'p',filterExpression:'filterTableFind',hideTFootOnFilter:false,highlightClass:'alt',ignoreClass:'',ignoreColumns:[],inputSelector:null,inputName:'',inputType:'search',label:'Filter:',minChars:1,minRows:8,placeholder:'search this table',preventReturnKey:true,quickList:[],quickListClass:'quick',quickListGroupTag:'',quickListTag:'a',visibleClass:'visible'},hsc=function(text){return text.replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');},settings=$.extend({},defaults,options);var doFiltering=function(table,q){var tbody=table.find('tbody');if(q===''||q.length<settings.minChars){tbody.find('tr').show().addClass(settings.visibleClass);tbody.find('td').removeClass(settings.highlightClass);if(settings.hideTFootOnFilter){table.find('tfoot').show();}}else{var all_tds=tbody.find('td');tbody.find('tr').hide().removeClass(settings.visibleClass);all_tds.removeClass(settings.highlightClass);if(settings.hideTFootOnFilter){table.find('tfoot').hide();}
if(settings.ignoreColumns.length){var tds=[];if(settings.ignoreClass){all_tds=all_tds.not('.'+settings.ignoreClass);}
tds=all_tds.filter(':'+settings.filterExpression+'("'+q+'")');tds.each(function(){var t=$(this),col=t.parent().children().index(t);if($.inArray(col,settings.ignoreColumns)===-1){t.addClass(settings.highlightClass).closest('tr').show().addClass(settings.visibleClass);}});}else{if(settings.ignoreClass){all_tds=all_tds.not('.'+settings.ignoreClass);}
all_tds.filter(':'+settings.filterExpression+'("'+q+'")').addClass(settings.highlightClass).closest('tr').show().addClass(settings.visibleClass);}}
if(settings.callback){settings.callback(q,table);}};return this.each(function(){var t=$(this),tbody=t.find('tbody'),container=null,quicks=null,filter=null,created_filter=true;if(t[0].nodeName==='TABLE'&&tbody.length>0&&(settings.minRows===0||(settings.minRows>0&&tbody.find('tr').length>=settings.minRows))&&!t.prev().hasClass(settings.containerClass)){if(settings.inputSelector&&$(settings.inputSelector).length===1){filter=$(settings.inputSelector);container=filter.parent();created_filter=false;}else{container=$('<'+settings.containerTag+' />');if(settings.containerClass!==''){container.addClass(settings.containerClass);}
container.prepend(settings.label+' ');filter=$('<input type="'+settings.inputType+'" placeholder="'+settings.placeholder+'" name="'+settings.inputName+'" />');if(settings.preventReturnKey){filter.on('keydown',function(ev){if((ev.keyCode||ev.which)===13){ev.preventDefault();return false;}});}}
if(settings.autofocus){filter.attr('autofocus',true);}
if($.fn.bindWithDelay){filter.bindWithDelay('keyup',function(){doFiltering(t,$(this).val());},200);}else{filter.bind('keyup',function(){doFiltering(t,$(this).val());});}
filter.bind('click search input paste blur',function(){doFiltering(t,$(this).val());});if(created_filter){container.append(filter);}
if(settings.quickList.length>0){quicks=settings.quickListGroupTag?$('<'+settings.quickListGroupTag+' />'):container;$.each(settings.quickList,function(index,value){var q=$('<'+settings.quickListTag+' class="'+settings.quickListClass+'" />');q.text(hsc(value));if(q[0].nodeName==='A'){q.attr('href','#');}
q.bind('click',function(e){e.preventDefault();filter.val(value).focus().trigger('click');});quicks.append(q);});if(quicks!==container){container.append(quicks);}}
if(created_filter){t.before(container);}}});};})(jQuery);